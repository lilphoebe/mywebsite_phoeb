"0","#shags are on a different track then the other auks, so we'll exclude them from"
"0","#this analysis"
"0","sc <- success %>% "
"0","  filter(species != ""Shag"")"
"0",""
"0","#we'll use maximum june temperature as our climate indicator:"
"0","climate <- read.csv(""clim_east_Scotland.csv"")"
"0",""
"0","#pulling out year & june max temp:"
"0","june <- climate %>% "
"0","  filter(var == ""tmax"") %>% "
"0","  select(Year, JUN) %>%"
"0","  mutate(Year = as.numeric(Year)) %>%"
"0","  filter(Year %in% sc$year)"
"0",""
"0","#a function to find & assign temperature:"
"0","find_temp <- function(year) {"
"0","  temperature <- june[june$Year == year,2]"
"0","}"
"0",""
"0","#moving rowwise to assign temperature by year:"
"0","sc <- sc %>%"
"0","  mutate(year = as.numeric(year)) %>%"
"0","  rowwise() %>%"
"0","  mutate(temp = ifelse(year %in% unique(june$Year),"
"0","                       find_temp(year),"
"0","                       NA)) %>%"
"0","  ungroup()"
"0",""
"0","#and modify sc to exclude years with no temperature data, and a little renaming for clarity:"
"0","sc <- sc %>%"
"0","  filter(year >= 1986) %>%"
"0","  rename(bs = value)"
"0",""
"0","#adding a normalized year (ie, 1,2,3 etc rather than 1985...)"
"0","sc <- sc %>%"
"0","  mutate(nyear = as.factor(year-1985))"
"0",""
"0","#and scaling temperature so the mean is 0 and variation is represented by"
"0","#std deviations."
"0","sc$temp <- scale(sc$temp, center = TRUE, scale = TRUE)"
"0",""
"0","#let's visualize how temperature effects breeding success by species!"
"0","ggplot(sc, aes(x = temp, y = bs, color = species)) +"
"0","  geom_point() +"
"0","  facet_wrap(~species) +"
"0","  theme_bw() +"
"0","  scale_color_manual(values = birdpal) +"
"0","  theme(legend.position = ""none"") +"
"0","  labs(x= ""temperature (standard deviations)"", y=""breeding success"", title = ""how temperature affects breeding success by species"")"
